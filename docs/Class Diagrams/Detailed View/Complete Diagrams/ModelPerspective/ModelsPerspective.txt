@startuml
skinparam nodesep 50
'hide members

' --- RELATIONS ---
Student "1" -r- "3" Loan

Loan "*" -r-> "1" Book

BookRegister "1" -d-> "*" Book
BookRegister .u.|> "Register<T>"

StudentRegister "1" -d-> "*" Student
StudentRegister .u.|> "Register<T>"

LoanRegister "1" -d-> "*" Loan
LoanRegister .u.|> "Register<T>"

Library "1" -d-> "3" "Register<T>"


' --- CLASSES ---

class Student {
    - name : String
    - surname : String
    - studentId : String {readOnly}
    - email : String
    - activeLoans : List<Loan>

    + Student(name : String, surname : String, studentId : String, email : String)
    + getName() : String
    + getSurname() : String
    + getStudentId() : String
    + getEmail() : String
    + getActiveLoans() : List<Loan>
    + copy(newData : Student) : void
    + addActiveLoan(loanToAdd : Loan) : void
    + removeActiveLoan(loanToRemove : Loan) : void
    + isValid() : boolean
    + isAvailableForLoan() : boolean
    - isStudentIdValid(studentId : String) : boolean
    - isEmailValid(email : String) : boolean
}

class Loan {
    - loanId : UUID {readOnly}
    - student : Student {readOnly}
    - book : Book {readOnly}
    - loanEnd : LocalDate
    - returned : boolean

    + Loan(student : Student, book : Book, loanEnd : LocalDate)
    + getLoanId() : UUID
    + getStudent() : Student
    + getBook() : Book
    + getLoanEnd() : LocalDate
    + isReturned() : boolean
    + setLoanEnd(loanEnd : LocalDate) : void
    + returnLoan() : void
    + activateLoan() : void
    + isDelay() : boolean
    - isActivable() : boolean
    - isValid() : boolean
}

class Book {
    - title : String
    - authors : List<String>
    - bookId : String {readOnly}
    - publishmentYear : int
    - availableCopies : int

    + Book(title : String, authors : List<String>, bookId : String, publishmentYear : int, availableCopies : int)
    + getTitle() : String
    + getAuthors() : List<String>
    + getBookId() : String
    + getPublishmentYear() : int
    + getAvailableCopies() : int
    + setAvailableCopies(availableCopies : int) : void
    + copy(newData : Book) : void
    + isAvailableForLoan() : boolean
    - isValid() : boolean
    - isBookIdValid(bookId : String) : boolean
    - isPublishmentYearValid(publishmentYear : int) : boolean
    - isAvailableCopiesValid(availableCopies : int) : boolean
}

interface "Register<T>" {
    + add(toAdd : T) : void
    + modify(oldItem : T, newItem : T) : void
    + remove(toRemove : T) : void
    + isUnique(toVerify : T) : boolean
    + getRegisterList() : List<T>
}

class BookRegister {
    - bookRegister : Set<Book>

    + BookRegister()
}

class StudentRegister {
    - studentRegister : Set<Student>

    + StudentRegister()
}

class LoanRegister {
    - loanRegister : Set<Loan>

    + LoanRegister()
}

class Library {
    - bookRegister : Register<Book>
    - studentRegister : Register<Student>
    - loanRegister : Register<Loan>

    + Library()
    + getBookRegister() : Register<Book>
    + getStudentRegister() : Register<Student>
    + getLoanRegister() : Register<Loan>
}
@enduml