@startuml
skinparam nodesep 50
'hide members

' --- RELATIONS ---
BookRegisterController "1" -d-> "1" "SideBarController"
BookRegisterController "1" -d-> "1" "Register<T>"
BookRegisterController .l.> BookInsertPopupController
BookRegisterController .r.> BookModifyPopupController

BookInsertPopupController "1" -u-> "1" "RegisterAdder<T>"
BookInsertPopupController "1" -d-> "1" "RegisterValidator<T>"
BookInsertPopupController -u-|> BookPopupController


BookModifyPopupController "1" -u-> "1" "RegisterModifier<T>"
BookModifyPopupController -u-|> BookPopupController
BookModifyPopupController "1" -d-> "1" Book


' --- CLASSES ---

class Book {
    - title : String
    - authors : List<String>
    - bookId : String {readOnly}
    - publishmentYear : int
    - availableCopies : int

    + Book(title : String, authors : List<String>, bookId : String, publishmentYear : int, availableCopies : int)
    + getTitle() : String
    + getAuthors() : List<String>
    + getBookId() : String
    + getPublishmentYear() : int
    + getAvailableCopies() : int
    + setAvailableCopies(availableCopies : int) : void
    + copy(newData : Book) : void
    + isAvailableForLoan() : boolean
    - isValid() : boolean
    - isBookIdValid(bookId : String) : boolean
    - isPublishmentYearValid(publishmentYear : int) : boolean
    - isAvailableCopiesValid(availableCopies : int) : boolean
}

interface "Register<T>" {
    + add(toAdd : T) : void
    + modify(oldItem : T, newItem : T) : void
    + remove(toRemove : T) : void
    + isUnique(toVerify : T) : boolean
    + getRegisterList() : List<T>
}

interface "RegisterAdder<T>" {
    + add(toAdd : T) : void
}

interface "RegisterModifier<T>" {
    + modify(oldItem : T, newItem : T) : void
}

interface "RegisterValidator<T>" {
    + isUnique(toVerify : T) : boolean
}

class SideBarController {
    - addBtn : Button
    - searchBarTF : TextField
    - removeBtn : Button
    - modifyBtn : Button

    + getAddBtn() : Button
    + getSearchBarTF() : TextField
    + getRemoveBtn() : Button
    + getModifyBtn() : Button
}

class BookRegisterController {
    - bookTable : TableView<Book>
    - titleClm : TableColumn<Book, String>
    - authorsClm : TableColumn<Book, String>
    - publishmentYearClm : TableColumn<Book, Integer>
    - bookIdClm : TableColumn<Book, String>
    - availableCopiesClm : TableColumn<Book, Integer>
    - bookRegister : Register<Book>
    - sideBarController : SideBarController

    + BookRegisterController(bookRegister : Register<Book>)
    + initialize() : void
    - openInsertPopup() : void
    - openModifyPopup() : void
    - removeFromRegister() : void
    + updateTableView() : void
    - searchBook() : void
}

abstract class BookPopupController {
    # titleTF : TextField
    # authorsListVBox : VBox
    # Author1TF : TextField
    # publishYearTF : TextField
    # copiesTF : TextField
    # bookCodeTF : TextField
    # confirmBtn : Button
    # cancelBtn : Button
    # addAuthorsBtn : Button
    # dynamicAuthorFields : List<TextField>
    - removeImg : Image

    + initialize() : void
    - createAuthorRow(authorNum : int) : HBox
    # getAuthorsListPopup() : List<String>
    - addAuthors(event : ActionEvent) : void
    + {abstract} confirmBtnAction(event : ActionEvent) : void
    + cancelBtnAction(event : ActionEvent) : void
    # showAlert(type : Alert.AlertType, title : String, header : String, content : String) : void
}

class BookInsertPopupController {
    - bookRegisterAdder : RegisterAdder<Book>
    - bookRegisterValidator : RegisterValidator<Book>

    + BookInsertPopupController(bookRegisterAdder : RegisterAdder<Book>, bookRegisterValidator : RegisterValidator<Book>)
    + initialize() : void
}

class BookModifyPopupController {
    - bookRegisterModifier : RegisterModifier<Book>
    - bookToModify : Book

    + BookModifyPopupController(bookRegisterModifier : RegisterModifier<Book>, bookToModify : Book)
    + initialize() : void
}

@enduml