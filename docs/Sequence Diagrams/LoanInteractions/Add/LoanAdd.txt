@startuml
'DIAGRAMMA DI SEQUENZA DELL'INSERIMENTO DI UN LOAN

actor Admin

participant "<u>:LoanRegisterController" as LoanRegisterController
participant "<u>:LoanInsertPopupController" as LoanInsertPopupController
participant "<u>:LoanRegister" as LoanRegister
participant "<u>inserted :Loan" as Loan
participant "<u>insertedLoanBook :Book" as Book
participant "<u>insertedLoanStudent :Student" as Student

Admin -> LoanRegisterController : openInsertPopup()
LoanRegisterController --> Admin : "Shows Insert Popup"
Admin -> LoanInsertPopupController : confirmBtnAction(event)
LoanInsertPopupController -> LoanRegister : add(insertedLoan)
LoanRegister -> Loan : activateLoan()
Loan -> Loan : isActivable()
activate Loan
Loan -> Book : isAvailableForLoan()
Book --> Loan : result
Loan -> Student : isAvailableForLoan()
Student --> Loan : result
deactivate Loan
Loan -> Book : getAvailableCopies()
Book --> Loan : availableCopies
Loan -> Book : setAvailableCopies(availableCopies-1)
Loan -> Student : addActiveLoan(this)
@enduml
